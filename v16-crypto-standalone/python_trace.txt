TEST 1: Small exponent
============================================================
=== Tracing: 42^3 mod n ===
base = 42
exp = 3 (0x3, binary: 11)
mod first 8 bytes = 0xa73e9d978aeba112

Initial: result = 1, base_copy = 42

--- Iteration 0 (bit 0 of exponent) ---
Exponent bit = 1
  Bit is 1: result = (result * base_copy) mod n
           = (1 * 42) mod n
           = 42
           Low 32 bits: 0x0000002a
  Square base: base_copy = base_copy^2 mod n
             = 42^2 mod n
             = 1764
             Low 32 bits: 0x000006e4

--- Iteration 1 (bit 1 of exponent) ---
Exponent bit = 1
  Bit is 1: result = (result * base_copy) mod n
           = (42 * 1764) mod n
           = 74088
           Low 32 bits: 0x00012168

=== Final Result ===
result = 74088
result (hex) = 0x12168
Low 32 bits: 0x00012168 (74088)




TEST 2: Large exponent (first 10 iterations)
============================================================
=== Tracing: 42^65537 mod n ===
base = 42
exp = 65537 (0x10001, binary: 10000000000000001)
mod first 8 bytes = 0xa73e9d978aeba112

Initial: result = 1, base_copy = 42

--- Iteration 0 (bit 0 of exponent) ---
Exponent bit = 1
  Bit is 1: result = (result * base_copy) mod n
           = (1 * 42) mod n
           = 42
           Low 32 bits: 0x0000002a
  Square base: base_copy = base_copy^2 mod n
             = 42^2 mod n
             = 1764
             Low 32 bits: 0x000006e4

--- Iteration 1 (bit 1 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 42
  Square base: base_copy = base_copy^2 mod n
             = 1764^2 mod n
             = 3111696
             Low 32 bits: 0x002f7b10

--- Iteration 2 (bit 2 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 42
  Square base: base_copy = base_copy^2 mod n
             = 3111696^2 mod n
             = 9682651996416
             Low 32 bits: 0x6b086100

--- Iteration 3 (bit 3 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 42
  Square base: base_copy = base_copy^2 mod n
             = 9682651996416^2 mod n
             = 93753749683698750476845056
             Low 32 bits: 0x34c10000

--- Iteration 4 (bit 4 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 42
  Square base: base_copy = base_copy^2 mod n
             = 93753749683698750476845056^2 mod n
             = 8789765579753643555083504787829125689141207431643136
             Low 32 bits: 0x00000000

--- Iteration 5 (bit 5 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 42
  Square base: base_copy = base_copy^2 mod n
             = 8789765579753643555083504787829125689141207431643136^2 mod n
             = 77259978947021905600184340317603197947481177389714460678206771900175196402510074614992658926100855914496
             Low 32 bits: 0x00000000

--- Iteration 6 (bit 6 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 42
  Square base: base_copy = base_copy^2 mod n
             = 77259978947021905600184340317603197947481177389714460678206771900175196402510074614992658926100855914496^2 mod n
             = 5969104346894268081227127544369532170015095312194834027929354042567350669542387998506329070754173609675893918520514338828907331836642624775378397111250585828101167849594706641664032932626866298080824462934016
             Low 32 bits: 0x00000000

--- Iteration 7 (bit 7 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 42
  Square base: base_copy = base_copy^2 mod n
             = 5969104346894268081227127544369532170015095312194834027929354042567350669542387998506329070754173609675893918520514338828907331836642624775378397111250585828101167849594706641664032932626866298080824462934016^2 mod n
             = 35630206704112046697083571477486612999590587325758485046006317548508168556422590068317210397986918144252214852863603996895537092895950768002595498226292335108416412611585333411262637293792778244857315142220435896964541184962357855512757565586126410419765575678382983265098086200950365270560196542873914665817215138925255740618617734518932373494629331157108756162265337193556357868869001770926250194108126271169888256
             Low 32 bits: 0x00000000

--- Iteration 8 (bit 8 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 42
  Square base: base_copy = base_copy^2 mod n
             = 35630206704112046697083571477486612999590587325758485046006317548508168556422590068317210397986918144252214852863603996895537092895950768002595498226292335108416412611585333411262637293792778244857315142220435896964541184962357855512757565586126410419765575678382983265098086200950365270560196542873914665817215138925255740618617734518932373494629331157108756162265337193556357868869001770926250194108126271169888256^2 mod n
             = 8085983885600051883241274739275094532296419906249930726784883582175868739055724497861006862089414197677313761961125380710414874859585917149076827178455439985939907344832088544026119811056011964554951708634721145244736346366177203676107198548839064117849042877636391893757367599774027610698566536046112378326813435836388975018917035963959016672899223299750234355001835038006985235683674225347644798644049094424011717896076519762273884213522156024396553651714226386745450341070531672616901617111863959598933000107398716298048846732419865468151100488817708863259572391987049191257873670724813123506547143002560573589479
             Low 32 bits: 0x0ee1c7e7

--- Iteration 9 (bit 9 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 42
  Square base: base_copy = base_copy^2 mod n
             = 8085983885600051883241274739275094532296419906249930726784883582175868739055724497861006862089414197677313761961125380710414874859585917149076827178455439985939907344832088544026119811056011964554951708634721145244736346366177203676107198548839064117849042877636391893757367599774027610698566536046112378326813435836388975018917035963959016672899223299750234355001835038006985235683674225347644798644049094424011717896076519762273884213522156024396553651714226386745450341070531672616901617111863959598933000107398716298048846732419865468151100488817708863259572391987049191257873670724813123506547143002560573589479^2 mod n
             = 15406407725958818586745802033019042056400569335044991999207592916880122500700382100287657097487438404039855989423924918572689404528393665906534857610745594451627887744762767234664927087616436503757555376150666378347580335960346997278666478630275348821636597188370799487450451388940886198655283213525134265523125128401002604773910798753940709863560261875341336253153428775667704075786281563953678971284399803465106240240560092450022482013191557920661582129945946655307862257872386198817482597930323827850742233735121089612145641524759348945786715813740269848748556435175761425607433168956075395816217737885300428315443
             Low 32 bits: 0x55c71b33

... (stopping trace after 10 iterations)
=== Final Result ===
result = 2981367871258690619181249117543007216992726856857580195131075582973941179430080062564804294634040298419415138359128747237578169130777063590345041027438290871721286335031712072525611697144104662392292302212174156100914943894467047795248075658628572118432605324299022327116564435651661352023651682269233239684881215182181697405042870487090688407555271079183491951910342956934738476633767267223906994049878648330668276879837960268516162201674610034199875997846478931644569300633843451146488485805537094865769146352669372126248109865277621971110210443805671593110929639620463529707670468624368519531188692382582637989221
result (hex) = 0x179df294edfb9215fb5ab23f4ac4d33d7e1ef6e8a4f1f715ca31bb8c4a7e887a6baf5407ae4c737975dea74647499647ab856ea94f807c4d1ede1287b67aee75466b0c44e903ed4a5dcf75eeed71169ccf6f48a2ff9f73450b9f1e607e4d2537c7b10411ac14c28209ef478048856fbe666ae84d9f50e0735325ab9fda8233f48dc6fb036b7e55b635c084e5027f199432be7cbb682cb67a6f5eaff3c39e47e40f91e42fd21f532aafa78d5e2569a59b3b02aa238db6e50628ce2bec7aa102d4acf60a3ed5bc1f78d0b1270f00f8982c8c2192add2057c410a0ad9ed391e71930b23c26f9df86f733d5daeb752e9f2d2fb54fa3775a222bbc9d94d98f91e0d65
Low 32 bits: 0xf91e0d65 (4179496293)




TEST 3: Power of 2 exponent
============================================================
=== Tracing: 2^17 mod n ===
base = 2
exp = 17 (0x11, binary: 10001)
mod first 8 bytes = 0xa73e9d978aeba112

Initial: result = 1, base_copy = 2

--- Iteration 0 (bit 0 of exponent) ---
Exponent bit = 1
  Bit is 1: result = (result * base_copy) mod n
           = (1 * 2) mod n
           = 2
           Low 32 bits: 0x00000002
  Square base: base_copy = base_copy^2 mod n
             = 2^2 mod n
             = 4
             Low 32 bits: 0x00000004

--- Iteration 1 (bit 1 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 2
  Square base: base_copy = base_copy^2 mod n
             = 4^2 mod n
             = 16
             Low 32 bits: 0x00000010

--- Iteration 2 (bit 2 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 2
  Square base: base_copy = base_copy^2 mod n
             = 16^2 mod n
             = 256
             Low 32 bits: 0x00000100

--- Iteration 3 (bit 3 of exponent) ---
Exponent bit = 0
  Bit is 0: result unchanged = 2
  Square base: base_copy = base_copy^2 mod n
             = 256^2 mod n
             = 65536
             Low 32 bits: 0x00010000

--- Iteration 4 (bit 4 of exponent) ---
Exponent bit = 1
  Bit is 1: result = (result * base_copy) mod n
           = (2 * 65536) mod n
           = 131072
           Low 32 bits: 0x00020000

=== Final Result ===
result = 131072
result (hex) = 0x20000
Low 32 bits: 0x00020000 (131072)

