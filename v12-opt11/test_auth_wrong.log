[-] Unsupported auth method: none
[-] Failed to receive USERAUTH_REQUEST
=================================
Nano SSH Server v0-vanilla
=================================
Port: 2222
Version: SSH-2.0-NanoSSH_0.1
Credentials: user / password123
=================================

[+] Libsodium initialized
[+] Generated Ed25519 host key pair
[+] Server socket created and listening on port 2222
[+] Waiting for connections...


[+] Client connected: 127.0.0.1:37068
[+] Sent version: SSH-2.0-NanoSSH_0.1
[+] Received version: SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.14
[+] Version exchange complete
[+] Built KEXINIT payload (144 bytes)
[+] Sent KEXINIT
[+] Received client KEXINIT (1524 bytes)
[+] KEXINIT exchange complete
[+] Generated ephemeral key pair
[+] Built host key blob (51 bytes)
[+] Received client ephemeral public key (32 bytes)
[+] Computed shared secret
[+] Computed exchange hash H
[+] Set session_id
[+] Signed exchange hash (signature: 64 bytes)
[+] Sent KEX_ECDH_REPLY (179 bytes)
[+] Derived encryption keys:
    IV c2s: 16 bytes (AES-128-CTR)
    IV s2c: 16 bytes (AES-128-CTR)
    Key c2s: 16 bytes (AES-128)
    Key s2c: 16 bytes (AES-128)
    MAC c2s: 32 bytes (HMAC-SHA256)
    MAC s2c: 32 bytes (HMAC-SHA256)
[+] Sent SSH_MSG_NEWKEYS
[+] Activated outgoing encryption (server→client)
[+] Received SSH_MSG_NEWKEYS
[+] Activated incoming encryption (client→server)
[+] Encryption fully activated (AES-128-CTR + HMAC-SHA256)
    Send sequence: 3
    Recv sequence: 3
[+] Key exchange complete!
[DEBUG] Seq=3
  Encrypted (16 bytes): a8355162fa5c77a6c85997c321f4a3b6
  Decrypted: 0000001c0a050000000c7373682d7573
  packet_len=28

[+] Received SSH_MSG_SERVICE_REQUEST: ssh-userauth
[+] Sent SSH_MSG_SERVICE_ACCEPT
[DEBUG] Seq=4
  Encrypted (16 bytes): e0ccaccb8f2fd011a10a9889cbf0199d
  Decrypted: 0000002c083200000004757365720000
  packet_len=44

[+] Received USERAUTH_REQUEST:
    Username: user
    Service: ssh-connection
    Method: none
[+] Sent SSH_MSG_USERAUTH_FAILURE (unsupported method)
[DEBUG] Seq=5
  Encrypted (16 bytes): 743a8d8163f39909e157e5fde0bc2043
  Decrypted: 0000007c423200000004757365720000
  packet_len=124

[+] Received USERAUTH_REQUEST:
    Username: user
    Service: ssh-connection
    Method: password
    Password: wrongpassword
    Change password: no
[-] Authentication failed: invalid credentials
[+] Sent SSH_MSG_USERAUTH_FAILURE

[+] Server shutting down
